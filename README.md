# transfer_matrix_mode_soluter
求解1D模式
更新v1.1:
由于衬底折射率为1时远小于材料，导致γ在空气中很小，虽然Az收敛至很小，但随着距离很快光场发散。继续减小Az值意义不大，对材料内光场影响很小，因此调整为在求电场时在衬底中不包含Az项
加入了限制因子的计算

#######################
更新v1.1.1：
改善了预求解时tan函数发散导致的报错问题
限制因子计算时的有源区现在可以有多层

#######################
更新v1.2：
通过Maxwell方程，在波导解下推导得知，无论是否漏模，电场的导数也必须是连续的，因此在酋解器v1.1.1基础上应该可以通过迭代至Az=0得到正确的漏模解。结果发现，只有给衬底设置一个吸收，或者给有源区设置一个足够大的增益，才能求出合理的漏模解。现在，通过倍增增益的方法，在初次求解漏模问题收敛失败时，不断给有源区增加增益，最终可以得到漏模解。下一步希望继续微调迭代这个增益值，使得解的净增益为0，这样可以测得漏模的损耗。
主要原因在于，如果解为单向平面波漏模，则在衬底以上的区域中必须有净的向上的动量才能保证动量守恒（Maxwell方程蕴含了动量守恒，只有动量守恒才能成为其解），因此有源区的增益，即折射率的虚部可以导致原本的cos或sin解分解出的向上向下平面波的振幅不再相等，使得有净向上的动量。物理上，这对应着波导中向上反射的全反射波不再等于向下入射的，而有一部分损耗（即折射光漏光）。
此外，又重新在画图时增加了Az项，但是这次设置了画图时衬底的最大厚度，避免光场发散。
现在有漏模时会计算相应损耗并打印。预计后面开发远场酋解器，以及增益波导效应

#######################
更新v1.2：
改进使用downhill法迭代有源区折射率虚部（即增益），使得获得稳态解的效率与稳定性更高。
现在文件输出复数电场，可以从输出结果绘制远场。
